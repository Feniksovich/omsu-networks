# 1.2. Статическая маршрутизация. Маршруты по умолчанию

## Команды
Задание статического маршрута по умолчанию
```yaml
ip route 0.0.0.0 0.0.0.0 <next_hop>
```
Отобразить конфигурацию маршрутов
```yaml
show ip route
```
## Вводная информация
| Сеть       | Адрес       | Маска подсети   |
|----------- |-------------|-----------------|
| A (слева)  | 192.168.1.0 | 255.255.255.0   |
| B (справа) | 192.168.2.0 | 255.255.255.0   |
| C (сверху) | 192.168.3.0 | 255.255.255.0   |
| M1 ↔ M2    | 10.0.1.0    | 255.255.255.252 |
| M2 ↔ M3    | 10.0.2.0    | 255.255.255.252 |

### Топология
![topology](https://i.imgur.com/10uMA6r.png)

## Базовая конфигурация сети
### Маршрутизатор M1
```yaml
int fa0/0
    ip address 192.168.1.1 255.255.255.0
    no shutdown
    exit

int s2/0
    ip address 10.0.1.1 255.255.255.252
    no shutdown
    exit

ip route 192.168.2.0 255.255.255.0 10.0.1.2
```

### Маршрутизатор M2
```yaml
int fa0/0
    ip address 192.168.2.1 255.255.255.0
    no shutdown
    exit

int s2/0
    ip address 10.0.1.2 255.255.255.252
    no shutdown
    exit

int s3/0
    ip address 10.0.2.1 255.255.255.252
    no shutdown
    exit

ip route 192.168.1.0 255.255.255.0 10.0.1.1
```

### Router M3
```yaml
int fa0/0
    ip address 192.168.3.1 255.255.255.0
    no shutdown
    exit

int s3/0
    ip address 10.0.2.2 255.255.255.252
    no shutdown
    exit

ip route 192.168.1.0 255.255.255.0 10.0.1.1
```

## Конфигурирование маршрутов по умолчанию
### Маршрутизатор M1
```yaml
ip route 0.0.0.0 0.0.0.0 10.0.1.2 # направление трафика на M2
```

### Маршрутизатор M2
```yaml
ip route 0.0.0.0 0.0.0.0 10.0.2.2 # направление трафика на M3
```

### Маршрутизатор M3
```yaml
ip route 0.0.0.0 0.0.0.0 10.0.2.1 # направление трафика на M2
```

## Проверка конфигурации маршрутов
```yaml
show ip route
```
### Маршрутизатор M1
```yaml
Gateway of last resort is 10.0.1.2 to network 0.0.0.0

     10.0.0.0/30 is subnetted, 1 subnets
C       10.0.1.0 is directly connected, Serial2/0
C    192.168.1.0/24 is directly connected, FastEthernet0/0
S    192.168.2.0/24 [1/0] via 10.0.1.2
S*   0.0.0.0/0 [1/0] via 10.0.1.2
```

### Маршрутизатор M2
```yaml
Gateway of last resort is 10.0.2.2 to network 0.0.0.0

     10.0.0.0/30 is subnetted, 2 subnets
C       10.0.1.0 is directly connected, Serial2/0
C       10.0.2.0 is directly connected, Serial3/0
S    192.168.1.0/24 [1/0] via 10.0.1.1
C    192.168.2.0/24 is directly connected, FastEthernet0/0
S*   0.0.0.0/0 [1/0] via 10.0.2.2
```

### Маршрутизатор M3
```yaml
Gateway of last resort is 10.0.2.1 to network 0.0.0.0

     10.0.0.0/30 is subnetted, 1 subnets
C       10.0.2.0 is directly connected, Serial3/0
C    192.168.3.0/24 is directly connected, FastEthernet0/0
S*   0.0.0.0/0 [1/0] via 10.0.2.1
```

## Примеры использования маршрутов по умолчанию
### 192.168.1.2 (есть A) → 192.168.3.2 (сеть C)
1. 192.168.1.2 → M1
2. M1 → M2
    
    M1 перенаправляет трафик M2 по маршруту по умолчанию.
3. M2 → M3

    M2 перенаправляет трафик M3 по маршруту по умолчанию.
4. M3 → 192.168.3.2

    M3 перенаправляет трафик в сеть 192.168.3.0.

### 192.168.2.2 (сеть B) → 192.168.3.2 (сеть C)
1. 192.168.1.2 → M2
2. M2 → M3

    M2 перенаправляет трафик M3 по маршруту по умолчанию.
3. M3 → 192.168.3.2

    M3 перенаправляет трафик в сеть 192.168.3.0.

### 192.168.3.2 (сеть C) → 192.168.1.2 (сеть A)
1. 192.168.3.2 → M3
2. M3 → M2

    M3 перенаправляет трафик M2 по маршруту по умолчанию.
3. M2 → M1

    M2 имеет заданный статический маршрут для сети 192.168.1.0.
4. M1 → 192.168.1.2

    M1 перенаправляет трафик в сеть 192.168.1.0.